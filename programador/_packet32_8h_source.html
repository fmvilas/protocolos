<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Protocolos: Source/Packet32.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.0 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>Source/Packet32.h</h1>  </div>
</div>
<div class="contents">
<a href="_packet32_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * Copyright (c) 1999, 2000</span>
<a name="l00003"></a>00003 <span class="comment"> *      Politecnico di Torino.  All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> * Redistribution and use in source and binary forms, with or without</span>
<a name="l00006"></a>00006 <span class="comment"> * modification, are permitted provided that: (1) source code distributions</span>
<a name="l00007"></a>00007 <span class="comment"> * retain the above copyright notice and this paragraph in its entirety, (2)</span>
<a name="l00008"></a>00008 <span class="comment"> * distributions including binary code include the above copyright notice and</span>
<a name="l00009"></a>00009 <span class="comment"> * this paragraph in its entirety in the documentation or other materials</span>
<a name="l00010"></a>00010 <span class="comment"> * provided with the distribution, and (3) all advertising materials mentioning</span>
<a name="l00011"></a>00011 <span class="comment"> * features or use of this software display the following acknowledgement:</span>
<a name="l00012"></a>00012 <span class="comment"> * ``This product includes software developed by the Politecnico</span>
<a name="l00013"></a>00013 <span class="comment"> * di Torino, and its contributors.&#39;&#39; Neither the name of</span>
<a name="l00014"></a>00014 <span class="comment"> * the University nor the names of its contributors may be used to endorse</span>
<a name="l00015"></a>00015 <span class="comment"> * or promote products derived from this software without specific prior</span>
<a name="l00016"></a>00016 <span class="comment"> * written permission.</span>
<a name="l00017"></a>00017 <span class="comment"> * THIS SOFTWARE IS PROVIDED ``AS IS&#39;&#39; AND WITHOUT ANY EXPRESS OR IMPLIED</span>
<a name="l00018"></a>00018 <span class="comment"> * WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF</span>
<a name="l00019"></a>00019 <span class="comment"> * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.</span>
<a name="l00020"></a>00020 <span class="comment"> */</span>
<a name="l00021"></a>00021 
<a name="l00033"></a>00033 <span class="preprocessor">#ifndef __PACKET32</span>
<a name="l00034"></a>00034 <span class="preprocessor"></span><span class="preprocessor">#define __PACKET32</span>
<a name="l00035"></a>00035 <span class="preprocessor"></span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;winsock2.h&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;<a class="code" href="_d_e_v_i_o_c_t_l_8_h.html">devioctl.h</a>&quot;</span>
<a name="l00038"></a>00038 
<a name="l00039"></a>00039 <span class="comment">// Working modes</span>
<a name="l00040"></a><a class="code" href="group__packet32h.html#ga0b83deacb05c79fbd601f82bf2b0cb2c">00040</a> <span class="preprocessor">#define PACKET_MODE_CAPT 0x0 ///&lt; Capture mode</span>
<a name="l00041"></a><a class="code" href="group__packet32h.html#gad52877d092fec802ec3ac83085a1f9cc">00041</a> <span class="preprocessor"></span><span class="preprocessor">#define PACKET_MODE_STAT 0x1 ///&lt; Statistical mode</span>
<a name="l00042"></a><a class="code" href="group__packet32h.html#ga942a1cb1b70b6392d1d55c1ee8a25316">00042</a> <span class="preprocessor"></span><span class="preprocessor">#define PACKET_MODE_DUMP 0x10 ///&lt; Dump mode</span>
<a name="l00043"></a><a class="code" href="group__packet32h.html#ga4a3569b94fcd55721ee6a70052e13298">00043</a> <span class="preprocessor"></span><span class="preprocessor">#define PACKET_MODE_STAT_DUMP MODE_DUMP | MODE_STAT ///&lt; Statistical dump Mode</span>
<a name="l00044"></a>00044 <span class="preprocessor"></span>
<a name="l00045"></a>00045 <span class="comment">// ioctls</span>
<a name="l00046"></a><a class="code" href="group__packet32h.html#gad7edc7f8134169e219825992e1d17284">00046</a> <span class="preprocessor">#define FILE_DEVICE_PROTOCOL        0x8000</span>
<a name="l00047"></a>00047 <span class="preprocessor"></span>
<a name="l00048"></a><a class="code" href="group__packet32h.html#gadf4e8a533f12a7c2f23fa621cfdf7efe">00048</a> <span class="preprocessor">#define IOCTL_PROTOCOL_STATISTICS   CTL_CODE(FILE_DEVICE_PROTOCOL, 2 , METHOD_BUFFERED, FILE_ANY_ACCESS)</span>
<a name="l00049"></a><a class="code" href="group__packet32h.html#ga0f40724317433f0db0254a0773080784">00049</a> <span class="preprocessor"></span><span class="preprocessor">#define IOCTL_PROTOCOL_RESET        CTL_CODE(FILE_DEVICE_PROTOCOL, 3 , METHOD_BUFFERED, FILE_ANY_ACCESS)</span>
<a name="l00050"></a><a class="code" href="group__packet32h.html#gaa148dc2472f513a284214800444f1e2b">00050</a> <span class="preprocessor"></span><span class="preprocessor">#define IOCTL_PROTOCOL_READ         CTL_CODE(FILE_DEVICE_PROTOCOL, 4 , METHOD_BUFFERED, FILE_ANY_ACCESS)</span>
<a name="l00051"></a><a class="code" href="group__packet32h.html#ga7d017e95c5de3df3644d3290cea1e296">00051</a> <span class="preprocessor"></span><span class="preprocessor">#define IOCTL_PROTOCOL_WRITE        CTL_CODE(FILE_DEVICE_PROTOCOL, 5 , METHOD_BUFFERED, FILE_ANY_ACCESS)</span>
<a name="l00052"></a><a class="code" href="group__packet32h.html#ga1fe5af641d356ef8304658c87cb2a218">00052</a> <span class="preprocessor"></span><span class="preprocessor">#define IOCTL_PROTOCOL_MACNAME      CTL_CODE(FILE_DEVICE_PROTOCOL, 6 , METHOD_BUFFERED, FILE_ANY_ACCESS)</span>
<a name="l00053"></a><a class="code" href="group__packet32h.html#ga813beca2b7843356e9314d25feadd86a">00053</a> <span class="preprocessor"></span><span class="preprocessor">#define IOCTL_OPEN                  CTL_CODE(FILE_DEVICE_PROTOCOL, 7 , METHOD_BUFFERED, FILE_ANY_ACCESS)</span>
<a name="l00054"></a><a class="code" href="group__packet32h.html#ga48218e97f8e683f3b21475369228f8af">00054</a> <span class="preprocessor"></span><span class="preprocessor">#define IOCTL_CLOSE                 CTL_CODE(FILE_DEVICE_PROTOCOL, 8 , METHOD_BUFFERED, FILE_ANY_ACCESS)</span>
<a name="l00055"></a>00055 <span class="preprocessor"></span>
<a name="l00056"></a><a class="code" href="group__packet32h.html#gab1db347bc355939f7ade6b80874e0cdd">00056</a> <span class="preprocessor">#define  pBIOCSETBUFFERSIZE 9592                ///&lt; IOCTL code: set kernel buffer size.</span>
<a name="l00057"></a><a class="code" href="group__packet32h.html#ga7c471d5b65b87014daa762a01798b3f6">00057</a> <span class="preprocessor"></span><span class="preprocessor">#define  pBIOCSETF 9030                                 ///&lt; IOCTL code: set packet filtering program.</span>
<a name="l00058"></a><a class="code" href="group__packet32h.html#gaebbbf869073b024271f455854e5040a3">00058</a> <span class="preprocessor"></span><span class="preprocessor">#define  pBIOCGSTATS 9031                               ///&lt; IOCTL code: get the capture stats.</span>
<a name="l00059"></a><a class="code" href="group__packet32h.html#gafa3e4c8ffacd3642bca90e15ea9950e1">00059</a> <span class="preprocessor"></span><span class="preprocessor">#define  pBIOCSRTIMEOUT 7416                    ///&lt; IOCTL code: set the read timeout.</span>
<a name="l00060"></a><a class="code" href="group__packet32h.html#ga72527bb656667c374aac197ce149f3e3">00060</a> <span class="preprocessor"></span><span class="preprocessor">#define  pBIOCSMODE 7412                                ///&lt; IOCTL code: set working mode.</span>
<a name="l00061"></a><a class="code" href="group__packet32h.html#ga831a5668856192647155cc0d4f89d0e9">00061</a> <span class="preprocessor"></span><span class="preprocessor">#define  pBIOCSWRITEREP 7413                    ///&lt; IOCTL code: set number of physical repetions of every packet written by the app.</span>
<a name="l00062"></a><a class="code" href="group__packet32h.html#gacf37077c37e1d6cf0176a77209af5ece">00062</a> <span class="preprocessor"></span><span class="preprocessor">#define  pBIOCSMINTOCOPY 7414                   ///&lt; IOCTL code: set minimum amount of data in the kernel buffer that unlocks a read call.</span>
<a name="l00063"></a><a class="code" href="group__packet32h.html#gab65ec28096a62155f53286b2371abd21">00063</a> <span class="preprocessor"></span><span class="preprocessor">#define  pBIOCSETOID 2147483648                 ///&lt; IOCTL code: set an OID value.</span>
<a name="l00064"></a><a class="code" href="group__packet32h.html#ga27dab8b157ad1211cf857d52e6f5489a">00064</a> <span class="preprocessor"></span><span class="preprocessor">#define  pBIOCQUERYOID 2147483652               ///&lt; IOCTL code: get an OID value.</span>
<a name="l00065"></a><a class="code" href="group__packet32h.html#ga91f56c8fc477f2a711fc6dd59cafcd09">00065</a> <span class="preprocessor"></span><span class="preprocessor">#define  pATTACHPROCESS 7117                    ///&lt; IOCTL code: attach a process to the driver. Used in Win9x only.</span>
<a name="l00066"></a><a class="code" href="group__packet32h.html#ga2eb58739e5ff940476135b620f40f929">00066</a> <span class="preprocessor"></span><span class="preprocessor">#define  pDETACHPROCESS 7118                    ///&lt; IOCTL code: detach a process from the driver. Used in Win9x only.</span>
<a name="l00067"></a><a class="code" href="group__packet32h.html#ga75e75a7d2b3ade58de95a3a4dc522720">00067</a> <span class="preprocessor"></span><span class="preprocessor">#define  pBIOCSETDUMPFILENAME 9029              ///&lt; IOCTL code: set the name of a the file used by kernel dump mode.</span>
<a name="l00068"></a><a class="code" href="group__packet32h.html#ga6fe404086e9b1c2a06524d8e9bddbc22">00068</a> <span class="preprocessor"></span><span class="preprocessor">#define  pBIOCEVNAME 7415                               ///&lt; IOCTL code: get the name of the event that the driver signals when some data is present in the buffer.</span>
<a name="l00069"></a><a class="code" href="group__packet32h.html#ga751be01c6a694cf7588fed7e1ce9ae96">00069</a> <span class="preprocessor"></span><span class="preprocessor">#define  pBIOCSENDPACKETSNOSYNC 9032    ///&lt; IOCTL code: Send a buffer containing multiple packets to the network, ignoring the timestamps associated with the packets.</span>
<a name="l00070"></a><a class="code" href="group__packet32h.html#ga938972a48a595ebdd1d3945f87c1606f">00070</a> <span class="preprocessor"></span><span class="preprocessor">#define  pBIOCSENDPACKETSSYNC 9033              ///&lt; IOCTL code: Send a buffer containing multiple packets to the network, respecting the timestamps associated with the packets.</span>
<a name="l00071"></a><a class="code" href="group__packet32h.html#ga6ccd50355b3a69dcce1f3ecccd123223">00071</a> <span class="preprocessor"></span><span class="preprocessor">#define  pBIOCSETDUMPLIMITS 9034                ///&lt; IOCTL code: Set the dump file limits. See the PacketSetDumpLimits() function.</span>
<a name="l00072"></a><a class="code" href="group__packet32h.html#ga42c023cf13bbc6e6abc53d5d92b027fe">00072</a> <span class="preprocessor"></span><span class="preprocessor">#define  pBIOCISDUMPENDED 7411                  ///&lt; IOCTL code: Get the status of the kernel dump process. See the PacketIsDumpEnded() function.</span>
<a name="l00073"></a>00073 <span class="preprocessor"></span>
<a name="l00074"></a><a class="code" href="group__packet32h.html#ga5dcb4be5d6d559db22e09ba375cee030">00074</a> <span class="preprocessor">#define  pBIOCSTIMEZONE 7471                    ///&lt; IOCTL code: set time zone. Used in Win9x only.</span>
<a name="l00075"></a>00075 <span class="preprocessor"></span>
<a name="l00076"></a>00076 
<a name="l00078"></a><a class="code" href="group__packet32h.html#ga8463d2101446f74b83ed10006d772384">00078</a> <span class="preprocessor">#define Packet_ALIGNMENT sizeof(int)</span>
<a name="l00079"></a>00079 <span class="preprocessor"></span>
<a name="l00080"></a><a class="code" href="group__packet32h.html#ga6ad53095b69ed77878dc683754e3264a">00080</a> <span class="preprocessor">#define Packet_WORDALIGN(x) (((x)+(Packet_ALIGNMENT-1))&amp;~(Packet_ALIGNMENT-1))</span>
<a name="l00081"></a>00081 <span class="preprocessor"></span>
<a name="l00087"></a><a class="code" href="struct_net_type.html">00087</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct_net_type.html" title="Network type structure.">NetType</a>
<a name="l00088"></a>00088 {
<a name="l00089"></a><a class="code" href="struct_net_type.html#a2ecf8c35d4a3d488cbfe673f076010db">00089</a>         UINT <a class="code" href="struct_net_type.html#a2ecf8c35d4a3d488cbfe673f076010db" title="The MAC of the current network adapter (see function PacketGetNetType() for more...">LinkType</a>;  
<a name="l00090"></a><a class="code" href="group__packet32h.html#gaa9b5857dfca99b76ca97b65d1b11894e">00090</a>         UINT <a class="code" href="group__packet32h.html#gaa9b5857dfca99b76ca97b65d1b11894e" title="The speed of the network in bits per second.">LinkSpeed</a>; 
<a name="l00091"></a>00091 }<a class="code" href="struct_net_type.html" title="Network type structure.">NetType</a>;
<a name="l00092"></a>00092 
<a name="l00093"></a>00093 
<a name="l00094"></a>00094 <span class="comment">//some definitions stolen from libpcap</span>
<a name="l00095"></a>00095 
<a name="l00096"></a>00096 <span class="preprocessor">#ifndef BPF_MAJOR_VERSION</span>
<a name="l00097"></a>00097 <span class="preprocessor"></span>
<a name="l00103"></a><a class="code" href="structbpf__program.html">00103</a> <span class="keyword">struct </span><a class="code" href="structbpf__program.html" title="A BPF pseudo-assembly program.">bpf_program</a> {
<a name="l00104"></a><a class="code" href="structbpf__program.html#abaea35b84242604ef6d43b3a9f599f15">00104</a>         UINT <a class="code" href="structbpf__program.html#abaea35b84242604ef6d43b3a9f599f15" title="Indicates the number of instructions of the program, i.e. the number of struct bpf_insn...">bf_len</a>;                            
<a name="l00105"></a><a class="code" href="group__packet32h.html#ga0154fac80d1fe5e15e7482706b5be29e">00105</a>         <span class="keyword">struct </span><a class="code" href="structbpf__insn.html" title="A single BPF pseudo-instruction.">bpf_insn</a> *<a class="code" href="group__packet32h.html#ga0154fac80d1fe5e15e7482706b5be29e" title="A pointer to the first instruction of the program.">bf_insns</a>;      
<a name="l00106"></a>00106 };
<a name="l00107"></a>00107 
<a name="l00113"></a><a class="code" href="structbpf__insn.html">00113</a> <span class="keyword">struct </span><a class="code" href="structbpf__insn.html" title="A single BPF pseudo-instruction.">bpf_insn</a> {
<a name="l00114"></a><a class="code" href="structbpf__insn.html#aec838250f22945fcd28784928dee0bd4">00114</a>         USHORT  <a class="code" href="structbpf__insn.html#aec838250f22945fcd28784928dee0bd4" title="Instruction type and addressing mode.">code</a>;           
<a name="l00115"></a><a class="code" href="group__packet32h.html#ga2cf02fa8c3c9fa48f638e3927344d4f5">00115</a>         UCHAR   <a class="code" href="group__packet32h.html#ga2cf02fa8c3c9fa48f638e3927344d4f5" title="Jump if true.">jt</a>;                     
<a name="l00116"></a><a class="code" href="group__packet32h.html#ga519073c08ed4992a31ef7023c4618f1a">00116</a>         UCHAR   <a class="code" href="group__packet32h.html#ga519073c08ed4992a31ef7023c4618f1a" title="Jump if false.">jf</a>;                     
<a name="l00117"></a><a class="code" href="group__packet32h.html#ga044f5cc795973d4f89a4da1849417efa">00117</a>         <span class="keywordtype">int</span> <a class="code" href="group__packet32h.html#ga044f5cc795973d4f89a4da1849417efa" title="Generic field used for various purposes.">k</a>;                          
<a name="l00118"></a>00118 };
<a name="l00119"></a>00119 
<a name="l00125"></a><a class="code" href="structbpf__stat.html">00125</a> <span class="keyword">struct </span><a class="code" href="structbpf__stat.html" title="Structure that contains a couple of statistics values on the current capture.">bpf_stat</a> {
<a name="l00126"></a><a class="code" href="structbpf__stat.html#a4c2993986f659cc03f0955aedf6d8f81">00126</a>         UINT <a class="code" href="structbpf__stat.html#a4c2993986f659cc03f0955aedf6d8f81">bs_recv</a>;           
<a name="l00127"></a>00127 
<a name="l00128"></a>00128 
<a name="l00129"></a><a class="code" href="group__packet32h.html#gaf59db445fbf12ef54b8eeec9dbf15591">00129</a>         UINT <a class="code" href="group__packet32h.html#gaf59db445fbf12ef54b8eeec9dbf15591">bs_drop</a>;           
<a name="l00130"></a>00130 
<a name="l00131"></a>00131 
<a name="l00132"></a><a class="code" href="group__packet32h.html#ga6a32eace4b189be8810ffa330156678b">00132</a>         UINT <a class="code" href="group__packet32h.html#ga6a32eace4b189be8810ffa330156678b" title="drops by interface. XXX not yet supported">ps_ifdrop</a>;         
<a name="l00133"></a><a class="code" href="group__packet32h.html#gacb8d4f1eb16cfb8cdc55f71bc2b0bce0">00133</a>         UINT <a class="code" href="group__packet32h.html#gacb8d4f1eb16cfb8cdc55f71bc2b0bce0" title="thus reach the application.">bs_capt</a>;           
<a name="l00134"></a>00134 
<a name="l00135"></a>00135 };
<a name="l00136"></a>00136 
<a name="l00142"></a><a class="code" href="structbpf__hdr.html">00142</a> <span class="keyword">struct </span><a class="code" href="structbpf__hdr.html" title="Packet header.">bpf_hdr</a> {
<a name="l00143"></a><a class="code" href="structbpf__hdr.html#a086ebd19a4a5de5e9970fd4e1fb1a2a3">00143</a>         <span class="keyword">struct </span>timeval  <a class="code" href="structbpf__hdr.html#a086ebd19a4a5de5e9970fd4e1fb1a2a3" title="It is stored in a TimeVal structure.">bh_tstamp</a>;      
<a name="l00144"></a>00144 
<a name="l00145"></a><a class="code" href="group__packet32h.html#ga99a6b8285db013fd1916e8e6ff1bbc1b">00145</a>         UINT    <a class="code" href="group__packet32h.html#ga99a6b8285db013fd1916e8e6ff1bbc1b">bh_caplen</a>;                      
<a name="l00146"></a>00146 
<a name="l00147"></a>00147 
<a name="l00148"></a><a class="code" href="group__packet32h.html#ga0ea7509b28d57386b3403fe7e1c3532c">00148</a>         UINT    <a class="code" href="group__packet32h.html#ga0ea7509b28d57386b3403fe7e1c3532c" title="Original length of packet.">bh_datalen</a>;                     
<a name="l00149"></a><a class="code" href="group__packet32h.html#ga22814a7009010193b57522082f3f8483">00149</a>         USHORT          <a class="code" href="group__packet32h.html#ga22814a7009010193b57522082f3f8483">bh_hdrlen</a>;              
<a name="l00150"></a>00150 
<a name="l00151"></a>00151 
<a name="l00152"></a>00152 
<a name="l00153"></a>00153 };
<a name="l00154"></a>00154 
<a name="l00162"></a><a class="code" href="structdump__bpf__hdr.html">00162</a> <span class="keyword">struct </span><a class="code" href="structdump__bpf__hdr.html" title="Dump packet header.">dump_bpf_hdr</a>{
<a name="l00163"></a><a class="code" href="structdump__bpf__hdr.html#a072c915f2c8a21d35511abb1c2b8a7d0">00163</a>     <span class="keyword">struct </span>timeval      <a class="code" href="structdump__bpf__hdr.html#a072c915f2c8a21d35511abb1c2b8a7d0" title="Time stamp of the packet.">ts</a>;                     
<a name="l00164"></a><a class="code" href="group__packet32h.html#ga3606d41bdedda8cd2034a13a2b97544d">00164</a>     UINT                        <a class="code" href="group__packet32h.html#ga3606d41bdedda8cd2034a13a2b97544d">caplen</a>;         
<a name="l00165"></a>00165 
<a name="l00166"></a>00166 
<a name="l00167"></a><a class="code" href="group__packet32h.html#gaf9a52f7717067c1a59319f8cb0b046bb">00167</a>     UINT                        <a class="code" href="group__packet32h.html#gaf9a52f7717067c1a59319f8cb0b046bb" title="Length of the original packet (off wire).">len</a>;            
<a name="l00168"></a>00168 };
<a name="l00169"></a>00169 
<a name="l00170"></a>00170 
<a name="l00171"></a>00171 <span class="preprocessor">#endif</span>
<a name="l00172"></a>00172 <span class="preprocessor"></span>
<a name="l00173"></a><a class="code" href="group__packet32h.html#gaaa7b462e10c63bf143432fb626b47001">00173</a> <span class="preprocessor">#define        DOSNAMEPREFIX   TEXT(&quot;Packet_&quot;)  ///&lt; Prefix added to the adapters device names to create the WinPcap devices</span>
<a name="l00174"></a><a class="code" href="group__packet32h.html#ga1fbe7bcd6cd19f4d2cbd31ac0325c95e">00174</a> <span class="preprocessor"></span><span class="preprocessor">#define        MAX_LINK_NAME_LENGTH     64                      //&lt; Maximum length of the devices symbolic links</span>
<a name="l00175"></a><a class="code" href="group__packet32h.html#gaf647132220fbbd7eb7d557fff2386da3">00175</a> <span class="preprocessor"></span><span class="preprocessor">#define        NMAX_PACKET 65535</span>
<a name="l00176"></a>00176 <span class="preprocessor"></span>
<a name="l00183"></a><a class="code" href="struct___a_d_a_p_t_e_r.html">00183</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct___a_d_a_p_t_e_r.html" title="Describes a network adapter.">_ADAPTER</a>  { 
<a name="l00184"></a><a class="code" href="struct___a_d_a_p_t_e_r.html#a1a55e6a2b2e6f31d8c4b037381dcd01b">00184</a>         HANDLE <a class="code" href="struct___a_d_a_p_t_e_r.html#a1a55e6a2b2e6f31d8c4b037381dcd01b">hFile</a>;                           
<a name="l00185"></a><a class="code" href="group__packet32h.html#gaaf7618f526b1f49ce3f1e72f587088e9">00185</a>         CHAR  <a class="code" href="group__packet32h.html#gaaf7618f526b1f49ce3f1e72f587088e9">SymbolicLink</a>[MAX_LINK_NAME_LENGTH]; 
<a name="l00186"></a><a class="code" href="group__packet32h.html#ga14ea4ee3fc18492b7c56657e58638f1e">00186</a>         <span class="keywordtype">int</span> <a class="code" href="group__packet32h.html#ga14ea4ee3fc18492b7c56657e58638f1e" title="on the wire.">NumWrites</a>;                          
<a name="l00187"></a>00187 
<a name="l00188"></a><a class="code" href="group__packet32h.html#gab558e0a5524518a17fcd4971ecd7787e">00188</a>         HANDLE <a class="code" href="group__packet32h.html#gab558e0a5524518a17fcd4971ecd7787e">ReadEvent</a>;                       
<a name="l00189"></a>00189 
<a name="l00190"></a>00190 
<a name="l00191"></a>00191 
<a name="l00192"></a>00192 
<a name="l00193"></a>00193 
<a name="l00194"></a>00194 
<a name="l00195"></a>00195         
<a name="l00196"></a><a class="code" href="group__packet32h.html#ga8a9e21754948183bee9c6bb24b724df0">00196</a>         UINT <a class="code" href="group__packet32h.html#ga8a9e21754948183bee9c6bb24b724df0" title="ReadEvent will be signaled, also if no packets were captured.">ReadTimeOut</a>;                       
<a name="l00197"></a>00197 
<a name="l00198"></a>00198 }  <a class="code" href="struct___a_d_a_p_t_e_r.html" title="Describes a network adapter.">ADAPTER</a>, *<a class="code" href="struct___a_d_a_p_t_e_r.html" title="Describes a network adapter.">LPADAPTER</a>;
<a name="l00199"></a>00199 
<a name="l00205"></a><a class="code" href="struct___p_a_c_k_e_t.html">00205</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct___p_a_c_k_e_t.html" title="Structure that contains a group of packets coming from the driver.">_PACKET</a> {  
<a name="l00206"></a><a class="code" href="struct___p_a_c_k_e_t.html#a040a7df39bd6646da4d0f742c0777b37">00206</a>         HANDLE       <a class="code" href="struct___p_a_c_k_e_t.html#a040a7df39bd6646da4d0f742c0777b37">hEvent</a>;            
<a name="l00207"></a><a class="code" href="group__packet32h.html#ga99a2fddbeb31567a12eab3f8e5b4e9de">00207</a>         OVERLAPPED   <a class="code" href="group__packet32h.html#ga99a2fddbeb31567a12eab3f8e5b4e9de">OverLapped</a>;        
<a name="l00208"></a><a class="code" href="group__packet32h.html#ga3c2cab6daf3a53289f6dfc171f009f67">00208</a>         PVOID        <a class="code" href="group__packet32h.html#ga3c2cab6daf3a53289f6dfc171f009f67" title="details about the organization of the data in this buffer">Buffer</a>;            
<a name="l00209"></a>00209 
<a name="l00210"></a><a class="code" href="group__packet32h.html#ga433305c8d8f339cd0e7927c5460c4caf">00210</a>         UINT         <a class="code" href="group__packet32h.html#ga433305c8d8f339cd0e7927c5460c4caf" title="Length of the buffer.">Length</a>;            
<a name="l00211"></a><a class="code" href="group__packet32h.html#ga4f7b16f36290210bb6555ac3dbb193d2">00211</a>         DWORD        <a class="code" href="group__packet32h.html#ga4f7b16f36290210bb6555ac3dbb193d2" title="received by the last call to PacketReceivePacket()">ulBytesReceived</a>;   
<a name="l00212"></a>00212 
<a name="l00213"></a><a class="code" href="group__packet32h.html#gac5904028cfd301aabe004ec62eee0380">00213</a>         BOOLEAN      <a class="code" href="group__packet32h.html#gac5904028cfd301aabe004ec62eee0380">bIoComplete</a>;       
<a name="l00214"></a>00214 }  <a class="code" href="struct___p_a_c_k_e_t.html" title="Structure that contains a group of packets coming from the driver.">PACKET</a>, *<a class="code" href="struct___p_a_c_k_e_t.html" title="Structure that contains a group of packets coming from the driver.">LPPACKET</a>;
<a name="l00215"></a>00215 
<a name="l00223"></a><a class="code" href="struct___p_a_c_k_e_t___o_i_d___d_a_t_a.html">00223</a> <span class="keyword">struct </span><a class="code" href="struct___p_a_c_k_e_t___o_i_d___d_a_t_a.html" title="Structure containing an OID request.">_PACKET_OID_DATA</a> {
<a name="l00224"></a><a class="code" href="struct___p_a_c_k_e_t___o_i_d___d_a_t_a.html#a743b330998688fcaa6f5339f9fcc46e5">00224</a>     ULONG <a class="code" href="struct___p_a_c_k_e_t___o_i_d___d_a_t_a.html#a743b330998688fcaa6f5339f9fcc46e5" title="for a complete list of valid codes.">Oid</a>;                                  
<a name="l00225"></a>00225 
<a name="l00226"></a><a class="code" href="group__packet32h.html#ga0d06320feef7a54bd95ba4335d830256">00226</a>     ULONG <a class="code" href="group__packet32h.html#ga0d06320feef7a54bd95ba4335d830256" title="Length of the data field.">Length</a>;                               
<a name="l00227"></a><a class="code" href="group__packet32h.html#ga782d481f35f561916f97fe7107d35133">00227</a>     UCHAR <a class="code" href="group__packet32h.html#ga782d481f35f561916f97fe7107d35133" title="from the adapter.">Data</a>[1];                              
<a name="l00228"></a>00228 
<a name="l00229"></a>00229 }; 
<a name="l00230"></a><a class="code" href="group__packet32h.html#gadf678e4006b707eb64a691e611975b22">00230</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct___p_a_c_k_e_t___o_i_d___d_a_t_a.html" title="Structure containing an OID request.">_PACKET_OID_DATA</a> <a class="code" href="struct___p_a_c_k_e_t___o_i_d___d_a_t_a.html" title="Structure containing an OID request.">PACKET_OID_DATA</a>, *<a class="code" href="struct___p_a_c_k_e_t___o_i_d___d_a_t_a.html" title="Structure containing an OID request.">PPACKET_OID_DATA</a>;
<a name="l00231"></a>00231 
<a name="l00238"></a><a class="code" href="structnpf__if__addr.html">00238</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structnpf__if__addr.html" title="Addresses of a network adapter.">npf_if_addr</a> {
<a name="l00239"></a><a class="code" href="structnpf__if__addr.html#abf34ffa7e1be86fc89788ee49e60e982">00239</a>         <span class="keyword">struct </span>sockaddr <a class="code" href="structnpf__if__addr.html#abf34ffa7e1be86fc89788ee49e60e982" title="IP address.">IPAddress</a>;      
<a name="l00240"></a><a class="code" href="group__packet32h.html#ga3bafe34491c62d976efe6fc59492a3cc">00240</a>         <span class="keyword">struct </span>sockaddr <a class="code" href="group__packet32h.html#ga3bafe34491c62d976efe6fc59492a3cc" title="Netmask for that address.">SubnetMask</a>;     
<a name="l00241"></a><a class="code" href="group__packet32h.html#ga7bdcf772aadc80b1a80d31e39aba905b">00241</a>         <span class="keyword">struct </span>sockaddr <a class="code" href="group__packet32h.html#ga7bdcf772aadc80b1a80d31e39aba905b" title="Broadcast address.">Broadcast</a>;      
<a name="l00242"></a>00242 }<a class="code" href="structnpf__if__addr.html" title="Addresses of a network adapter.">npf_if_addr</a>;
<a name="l00243"></a>00243 
<a name="l00244"></a>00244 <span class="preprocessor">#ifdef __cplusplus</span>
<a name="l00245"></a>00245 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> {
<a name="l00246"></a>00246 <span class="preprocessor">#endif</span>
<a name="l00247"></a>00247 <span class="preprocessor"></span>
<a name="l00252"></a>00252 <span class="comment">//---------------------------------------------------------------------------</span>
<a name="l00253"></a>00253 <span class="comment">// FUNCTIONS</span>
<a name="l00254"></a>00254 <span class="comment">//---------------------------------------------------------------------------</span>
<a name="l00255"></a>00255 
<a name="l00256"></a>00256 PCHAR <a class="code" href="group__packet32h.html#ga7d09440a21ef7f6d86cba8ec5e70c8a4">PacketGetVersion</a>();
<a name="l00257"></a>00257 BOOLEAN <a class="code" href="group__packet32h.html#ga9ce4aabe77775d6571d7396b8b5b4963">PacketSetMinToCopy</a>(LPADAPTER AdapterObject,<span class="keywordtype">int</span> nbytes);
<a name="l00258"></a>00258 BOOLEAN <a class="code" href="group__packet32h.html#ga05105760f1abe6f1b04baf95b2b4f6dc">PacketSetNumWrites</a>(LPADAPTER AdapterObject,<span class="keywordtype">int</span> nwrites);
<a name="l00259"></a>00259 BOOLEAN <a class="code" href="group__packet32h.html#ga14d26e7d2ad20cea71dde5acf83c42e0">PacketSetMode</a>(LPADAPTER AdapterObject,<span class="keywordtype">int</span> mode);
<a name="l00260"></a>00260 BOOLEAN <a class="code" href="group__packet32h.html#ga086f1c61a9c6e702a4a4e56023a1c178">PacketSetReadTimeout</a>(LPADAPTER AdapterObject,<span class="keywordtype">int</span> timeout);
<a name="l00261"></a>00261 BOOLEAN <a class="code" href="group__packet32h.html#ga0cc9a9c0f4f0a40e9247653dc4c113cb">PacketSetBpf</a>(LPADAPTER AdapterObject,<span class="keyword">struct</span> <a class="code" href="structbpf__program.html" title="A BPF pseudo-assembly program.">bpf_program</a> *fp);
<a name="l00262"></a>00262 BOOLEAN <a class="code" href="group__packet32h.html#gafb3fbe3db6e386be9f57f0f129d90951">PacketGetStats</a>(LPADAPTER AdapterObject,<span class="keyword">struct</span> <a class="code" href="structbpf__stat.html" title="Structure that contains a couple of statistics values on the current capture.">bpf_stat</a> *s);
<a name="l00263"></a>00263 BOOLEAN <a class="code" href="group__packet32h.html#gacfcc9ed51d5a854e68ca8c673f08fdb2">PacketGetStatsEx</a>(LPADAPTER AdapterObject,<span class="keyword">struct</span> <a class="code" href="structbpf__stat.html" title="Structure that contains a couple of statistics values on the current capture.">bpf_stat</a> *s);
<a name="l00264"></a>00264 BOOLEAN <a class="code" href="group__packet32h.html#ga13924440c1eb27f92e9234eba138ac91">PacketSetBuff</a>(LPADAPTER AdapterObject,<span class="keywordtype">int</span> dim);
<a name="l00265"></a>00265 BOOLEAN <a class="code" href="group__packet32h.html#gad7b42ed97e557cf9579b79e148412076">PacketGetNetType</a> (LPADAPTER AdapterObject,<a class="code" href="struct_net_type.html" title="Network type structure.">NetType</a> *type);
<a name="l00266"></a>00266 LPADAPTER <a class="code" href="group__packet32h.html#gacab47df7d7fab73852d8ddcdb98dc5bd">PacketOpenAdapter</a>(LPTSTR AdapterName);
<a name="l00267"></a>00267 BOOLEAN <a class="code" href="group__packet32h.html#ga1019e0b6d0a4bb65b3b4c5bad6279815">PacketSendPacket</a>(LPADAPTER AdapterObject,LPPACKET pPacket,BOOLEAN Sync);
<a name="l00268"></a>00268 INT <a class="code" href="group__packet32h.html#ga1edf575f235a79f52d2ec25bfba0dc1e">PacketSendPackets</a>(LPADAPTER AdapterObject,PVOID PacketBuff,ULONG Size, BOOLEAN Sync);
<a name="l00269"></a>00269 LPPACKET <a class="code" href="group__packet32h.html#ga0ef0dc53fe7133f45eb73081936d8371">PacketAllocatePacket</a>(<span class="keywordtype">void</span>);
<a name="l00270"></a>00270 VOID <a class="code" href="group__packet32h.html#gabadfe2ca352a689f05be2f5ededf9bd3">PacketInitPacket</a>(LPPACKET lpPacket,PVOID  Buffer,UINT  Length);
<a name="l00271"></a>00271 VOID <a class="code" href="group__packet32h.html#ga8c5cb91d4f50fe64ed76a27d4aee26b9">PacketFreePacket</a>(LPPACKET lpPacket);
<a name="l00272"></a>00272 BOOLEAN <a class="code" href="group__packet32h.html#ga1288083e2c001711cc8f565253e215be">PacketReceivePacket</a>(LPADAPTER AdapterObject,LPPACKET lpPacket,BOOLEAN Sync);
<a name="l00273"></a>00273 BOOLEAN <a class="code" href="group__packet32h.html#ga2e2319cb4851763bede5904b4f81b92b">PacketSetHwFilter</a>(LPADAPTER AdapterObject,ULONG Filter);
<a name="l00274"></a>00274 BOOLEAN <a class="code" href="group__packet32h.html#ga40db213621d83a40be5e98183122efaa">PacketGetAdapterNames</a>(PTSTR pStr,PULONG  BufferSize);
<a name="l00275"></a>00275 BOOLEAN <a class="code" href="group__packet32h.html#ga0eae9d4f1309c5bfcc7292b95a229ada">PacketGetNetInfo</a>(LPTSTR AdapterName, PULONG netp, PULONG maskp);
<a name="l00276"></a>00276 BOOLEAN <a class="code" href="group__packet32h.html#gaf972cb74905f620aea7bf9a2466bcef5">PacketGetNetInfoEx</a>(LPTSTR AdapterName, <a class="code" href="structnpf__if__addr.html" title="Addresses of a network adapter.">npf_if_addr</a>* buffer, PLONG NEntries);
<a name="l00277"></a>00277 BOOLEAN <a class="code" href="group__packet32h.html#gac2216b6b538b44e22c71975387eae37b">PacketRequest</a>(LPADAPTER  AdapterObject,BOOLEAN Set,PPACKET_OID_DATA  OidData);
<a name="l00278"></a>00278 HANDLE <a class="code" href="group__packet32h.html#ga06b22e750f37c06f294f55abd23e74ac">PacketGetReadEvent</a>(LPADAPTER AdapterObject);
<a name="l00279"></a>00279 BOOLEAN <a class="code" href="group__packet32h.html#ga596275cbcd737f10f8d9e846e4f83861">PacketSetDumpName</a>(LPADAPTER AdapterObject, <span class="keywordtype">void</span> *name, <span class="keywordtype">int</span> len);
<a name="l00280"></a>00280 BOOLEAN <a class="code" href="group__packet32h.html#ga6bde75891c9f74d2b2f40928f9dfedbf">PacketSetDumpLimits</a>(LPADAPTER AdapterObject, UINT maxfilesize, UINT maxnpacks);
<a name="l00281"></a>00281 BOOLEAN <a class="code" href="group__packet32h.html#gac6b78941fc6feb1b40752d51d02377bc">PacketIsDumpEnded</a>(LPADAPTER AdapterObject, BOOLEAN sync);
<a name="l00282"></a>00282 BOOL <a class="code" href="group__packet32h.html#gacd17431b5da93401c81d443f26d56841">PacketStopDriver</a>();
<a name="l00283"></a>00283 VOID <a class="code" href="group__packet32h.html#ga2432af274a7cff425b9d6b66924bbbeb">PacketCloseAdapter</a>(LPADAPTER lpAdapter);
<a name="l00284"></a>00284 
<a name="l00285"></a>00285 <span class="preprocessor">#ifdef __cplusplus</span>
<a name="l00286"></a>00286 <span class="preprocessor"></span>}
<a name="l00287"></a>00287 <span class="preprocessor">#endif </span>
<a name="l00288"></a>00288 <span class="preprocessor"></span>
<a name="l00289"></a>00289 <span class="preprocessor">#endif //__PACKET32</span>
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Jun 22 2010 19:52:54 for Protocolos by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.0 </small></address>
</body>
</html>
